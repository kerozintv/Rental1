{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\SHOR\\\\Desktop\\\\Projects\\\\rental-1\\\\src\\\\components\\\\RentForm.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport FormControl from '@material-ui/core/FormControl';\nimport { withStyles } from '@material-ui/core/styles';\nimport Select from '@material-ui/core/Select';\nimport createTheme from '@material-ui/core/styles';\nimport adatkezelesi from '../adatkezelesi.pdf';\nimport axios from 'axios';\nimport { useState, useEffect } from 'react';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core';\nimport DatePicker from \"react-datepicker\";\nimport { registerLocale, setDefaultLocale } from \"react-datepicker\";\nimport hu from 'date-fns/locale/hu';\nimport Swal from 'sweetalert2';\nimport { format, addDays, isWithinInterval } from 'date-fns';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _ = require('lodash');\n\nconst RentForm = () => {\n  _s();\n\n  const history = useHistory(); //   MUI Selects Setup\n\n  const [category, setCategory] = React.useState('');\n  const [carInfo, setCarInfo] = useState([]);\n  const [selected_category, Set_selected_category] = useState();\n  const [model, setModel] = useState();\n\n  const handleCategory = event => {\n    setCategory(event.target.value);\n    Set_selected_category(event.target.value);\n  };\n\n  const handleModels = event => {\n    setModel(event.target.value);\n  }; // Auto fills the form with user's details + user id: \n\n\n  const vezetek_nev = localStorage.getItem('v_nev');\n  const kereszt_nev = localStorage.getItem('k_nev');\n  const telefon = localStorage.getItem('phone');\n  const user_id = localStorage.getItem('user_id'); //  Gets the car details... \n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const fetchData = async () => {\n    const car_data = await axios.get(`/api/modelljeink`);\n    const car_info = await car_data.data.cars;\n    setCarInfo(car_info);\n  };\n\n  let car_list = carInfo.filter(function (cars) {\n    return cars.car_category === selected_category;\n  });\n  let selected_car = carInfo.filter(function (cars) {\n    return cars.car_name === model;\n  }); ///  Car's ID\n\n  const car_id = selected_car.map(car => car.id);\n  const car_rent_start = selected_car.map(car => car.car_rental_begin);\n  const car_rent_end = selected_car.map(car => car.car_rental_end);\n  var DateWarning = \"\"; ///  Check if dates are vaild\n\n  const DateCheck = () => {\n    const formatedStartDay = format(startDate, \"yyyy-MM-dd.\");\n    const formatedEndDay = format(endDate, \"yyyy-MM-dd.\"); // console.log(car_rent_start);\n    // console.log(car_rent_end);\n\n    if (Object.keys(car_rent_start).length !== 0 && Object.keys(car_rent_end).length !== 0) {\n      const checkStartInterval = isWithinInterval(new Date(formatedStartDay), {\n        start: new Date(car_rent_start),\n        end: new Date(car_rent_end)\n      });\n      const checkEndInterval = isWithinInterval(new Date(formatedEndDay), {\n        start: new Date(car_rent_start),\n        end: new Date(car_rent_end)\n      });\n\n      if (checkStartInterval || checkEndInterval === true) {\n        DateWarning = /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"date_warning\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Az \\xD6n \\xE1ltal v\\xE1laszott modell az al\\xE1bbi id\\u0151 intervallumban k\\xF6lcs\\xF6nz\\xE9s alatt \\xE1ll:\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 137,\n              columnNumber: 31\n            }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n              children: [car_rent_start, \" - \", car_rent_end, \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 31\n            }, this), \"K\\xE9rj\\xFCk v\\xE1lasszon m\\xE1sik modellt, vagy k\\xF6lcs\\xF6nz\\xE9si id\\u0151pontot!\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 31\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 29\n        }, this);\n      } else {\n        DateWarning = \"\";\n      }\n    } else {\n      DateWarning = \"\";\n    }\n  }; ////  Datepicker setup\n\n\n  const [startDate, setStartDate] = useState(null);\n  const [endDate, setendDate] = useState(null);\n  registerLocale('hu', hu);\n  setDefaultLocale('hu'); /// Send Notification \n\n  const alert = 200;\n\n  const sendNotifcation = e => {\n    axios.defaults.withCredentials = true;\n    axios.defaults.headers.post['Content-Type'] = 'application/json';\n    axios.defaults.headers.post['Accept'] = 'application/json';\n    const data = {\n      alert: alert,\n      user_id: user_id\n    };\n    axios.post('/api/kolcsonzes/push', data);\n  }; //  Caluclated Price\n\n\n  const duration = Math.abs(endDate - startDate);\n  const duration_in_days = Math.ceil(duration / (1000 * 60 * 60 * 24));\n  const price = selected_car.map(car => car.car_price);\n  const calculated_price = price * duration_in_days; ///  Handle form input \n\n  const [formInput, setformInput] = useState({\n    v_nev: '',\n    k_nev: '',\n    phone: '',\n    error_list: ['']\n  });\n\n  const handleInput = e => {\n    e.persist();\n    setformInput({ ...formInput,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const [ischecked, setischecked] = useState(false);\n\n  const handleIsChecked = e => {\n    setischecked(e.target.checked);\n  }; //  Rent form submit\n\n\n  const rentSubmit = e => {\n    axios.defaults.withCredentials = true;\n    axios.defaults.headers.post['Content-Type'] = 'application/json';\n    axios.defaults.headers.post['Accept'] = 'application/json';\n    e.preventDefault();\n    const data = {\n      v_nev: formInput.v_nev,\n      k_nev: formInput.k_nev,\n      phone: formInput.phone,\n      adat_checkbox: ischecked,\n      modell_id: car_id,\n      kolcsonzes_kezdete: startDate,\n      kolcsonzes_vege: endDate,\n      user_id: user_id,\n      error_list: []\n    };\n    axios.get('/sanctum/csrf-cookie').then(response => {\n      axios.post(`/api/kolcsonzes`, data).then(res => {\n        if (res.data.status === 200) {\n          Swal.fire({\n            title: res.data.message,\n            confirmButtonText: 'Ok',\n            icon: 'success'\n          }).then(result => {\n            if (result.isConfirmed) {\n              sendNotifcation();\n              history.push('/kolcsonzes');\n            }\n          });\n        } else {\n          setformInput({ ...formInput,\n            error_list: res.data.validation_errors\n          });\n        }\n      });\n    });\n  };\n\n  if (endDate !== null) {\n    console.log(car_rent_start); // Calls the checkdate function here\n    // if(car_rent_start.valueOf() === null) {\n    //     console.log(\"nigger\");\n    //     console.log(car_rent_start);\n    //     console.log(car_rent_end);\n    //     console.log(typeof(car_rent_start));\n    //     console.log(typeof(car_rent_end));\n    //     DateWarning = \"\";\n    // }  else {\n    //     console.log(\"nem nigger\");\n    //      console.log(car_rent_start.valueOf());\n    //     DateCheck();\n    //       }\n  } ////  If no starting date has been selected:\n\n\n  var kolcsonzesVege = '';\n\n  if (startDate !== null) {\n    kolcsonzesVege = /*#__PURE__*/_jsxDEV(DatePicker, {\n      selected: endDate,\n      onChange: date => setendDate(date),\n      minDate: addDays(startDate, 1),\n      placeholderText: \"K\\xF6lcs\\xF6nz\\xE9s v\\xE9ge:\",\n      dateFormat: \"yyyy-MM-dd.\",\n      showDisabledMonthNavigation: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 381,\n      columnNumber: 17\n    }, this);\n  } else {\n    kolcsonzesVege = '';\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"rent_form_container\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: rentSubmit,\n      className: \"rent_form\",\n      children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"\",\n        children: \"Vezet\\xE9kn\\xE9v:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        name: \"v_nev\",\n        onChange: handleInput,\n        type: \"text\",\n        Placeholder: vezetek_nev,\n        value: formInput.v_nev\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 409,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"error_message\",\n        children: formInput.error_list.v_nev\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"\",\n        children: \"Keresztn\\xE9v:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        name: \"k_nev\",\n        onChange: handleInput,\n        type: \"text\",\n        Placeholder: kereszt_nev,\n        value: formInput.k_nev\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"error_message\",\n        children: formInput.error_list.k_nev\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 419,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 420,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"\",\n        children: \"Telefonsz\\xE1m: (Helyes form\\xE1tum: 201231234 legfeljebb 9 karakter)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        name: \"phone\",\n        onChange: handleInput,\n        type: \"text\",\n        Placeholder: telefon,\n        value: formInput.phone\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"error_message\",\n        children: formInput.error_list.phone\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n        sx: {\n          m: 1,\n          minWidth: 800\n        },\n        children: [/*#__PURE__*/_jsxDEV(Select, {\n          value: category,\n          onChange: handleCategory,\n          autoWidth: true,\n          displayEmpty: true,\n          children: [/*#__PURE__*/_jsxDEV(MenuItem, {\n            name: \"car_category\",\n            value: '',\n            disabled: true,\n            children: \"Kateg\\xF3ria\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 435,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n            name: \"car_category\",\n            value: 'sedan',\n            children: \"Sedan\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 436,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n            name: \"car_category\",\n            value: 'kombi',\n            children: \"Kombi\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 437,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n            name: \"car_category\",\n            value: 'hibrid',\n            children: \"Hibrid\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 438,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n            name: \"car_category\",\n            value: 'furgon',\n            children: \"Furgon\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 439,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 441,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Select, {\n          value: model,\n          onChange: handleModels,\n          autoWidth: true,\n          displayEmpty: true,\n          children: [/*#__PURE__*/_jsxDEV(MenuItem, {\n            value: '',\n            disabled: true,\n            children: \"Modell\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 11\n          }, this), car_list.map(car => /*#__PURE__*/_jsxDEV(MenuItem, {\n            value: car.car_name,\n            children: car.car_name\n          }, car.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 450,\n            columnNumber: 13\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 8\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 458,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DatePicker, {\n        selected: startDate,\n        onChange: date => setStartDate(date),\n        minDate: addDays(new Date(), 1),\n        placeholderText: \"K\\xF6lcs\\xF6nz\\xE9s kezdete:\",\n        dateFormat: \"yyyy-MM-dd.\",\n        showDisabledMonthNavigation: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 10\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 470,\n        columnNumber: 9\n      }, this), kolcsonzesVege, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 475,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"error_message\",\n        children: formInput.error_list.kolcsonzes_kezdete\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"error_message\",\n        children: formInput.error_list.kolcsonzes_vege\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 479,\n        columnNumber: 12\n      }, this), DateWarning, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 483,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"( A minimum k\\xF6lcs\\xF6nz\\xE9si id\\u0151 1 nap! )\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 484,\n        columnNumber: 10\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 487,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"price_box\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"price_tag\",\n          children: [\"\\xC1r:  Kauci\\xF3 + \", calculated_price, \" Ft \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 489,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 488,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 491,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        name: \"adat_checkbox\",\n        onChange: handleIsChecked,\n        className: \"checkbox\",\n        type: \"checkbox\",\n        value: ischecked\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 492,\n        columnNumber: 9\n      }, this), \"* Elfogadom az \", /*#__PURE__*/_jsxDEV(\"a\", {\n        href: adatkezelesi,\n        rel: \"noopener noreferrer\",\n        target: \"_blank\",\n        children: \"adatkezel\\xE9si nyilatkozatot.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 492,\n        columnNumber: 136\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 493,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"error_message\",\n        children: formInput.error_list.adat_checkbox\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 494,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 495,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"primary_button\",\n        children: \"K\\xF6lcs\\xF6nz\\xE9s \\u2BC8\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 496,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 497,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 498,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 403,\n    columnNumber: 5\n  }, this);\n};\n\n_s(RentForm, \"26Kmpw03dlNXWHsfnqtGuo6fLGo=\", false, function () {\n  return [useHistory];\n});\n\n_c = RentForm;\nexport default RentForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"RentForm\");","map":{"version":3,"sources":["C:/Users/SHOR/Desktop/Projects/rental-1/src/components/RentForm.js"],"names":["React","Link","useHistory","makeStyles","Button","MenuItem","FormControl","withStyles","Select","createTheme","adatkezelesi","axios","useState","useEffect","InputLabel","createMuiTheme","ThemeProvider","DatePicker","registerLocale","setDefaultLocale","hu","Swal","format","addDays","isWithinInterval","_","require","RentForm","history","category","setCategory","carInfo","setCarInfo","selected_category","Set_selected_category","model","setModel","handleCategory","event","target","value","handleModels","vezetek_nev","localStorage","getItem","kereszt_nev","telefon","user_id","fetchData","car_data","get","car_info","data","cars","car_list","filter","car_category","selected_car","car_name","car_id","map","car","id","car_rent_start","car_rental_begin","car_rent_end","car_rental_end","DateWarning","DateCheck","formatedStartDay","startDate","formatedEndDay","endDate","Object","keys","length","checkStartInterval","Date","start","end","checkEndInterval","setStartDate","setendDate","alert","sendNotifcation","e","defaults","withCredentials","headers","post","duration","Math","abs","duration_in_days","ceil","price","car_price","calculated_price","formInput","setformInput","v_nev","k_nev","phone","error_list","handleInput","persist","name","ischecked","setischecked","handleIsChecked","checked","rentSubmit","preventDefault","adat_checkbox","modell_id","kolcsonzes_kezdete","kolcsonzes_vege","then","response","res","status","fire","title","message","confirmButtonText","icon","result","isConfirmed","push","validation_errors","console","log","kolcsonzesVege","date","m","minWidth"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,EAAeC,UAAf,QAAiC,kBAAjC;AACA,SAASC,UAAT,QAA2B,0BAA3B;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,OAAOC,QAAP,MAAqB,4BAArB;AACA,OAAOC,WAAP,MAAwB,+BAAxB;AACA,SAASC,UAAT,QAA2B,0BAA3B;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,OAAOC,WAAP,MAAwB,0BAAxB;AACA,OAAOC,YAAP,MAAyB,qBAAzB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAAQC,QAAR,EAAkBC,SAAlB,QAAkC,OAAlC;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AACA,SAAQC,cAAR,EAAwBC,aAAxB,QAA4C,mBAA5C;AACA,OAAOC,UAAP,MAAuB,kBAAvB;AACA,SAASC,cAAT,EAAyBC,gBAAzB,QAAkD,kBAAlD;AACA,OAAOC,EAAP,MAAe,oBAAf;AACA,OAAOC,IAAP,MAAiB,aAAjB;AACA,SAASC,MAAT,EAAiBC,OAAjB,EAA0BC,gBAA1B,QAAkD,UAAlD;;;AACA,IAAIC,CAAC,GAAGC,OAAO,CAAC,QAAD,CAAf;;AAIA,MAAMC,QAAQ,GAAG,MAAM;AAAA;;AAGvB,QAAMC,OAAO,GAAG1B,UAAU,EAA1B,CAHuB,CAKvB;;AAEE,QAAM,CAAC2B,QAAD,EAAWC,WAAX,IAA0B9B,KAAK,CAACY,QAAN,CAAe,EAAf,CAAhC;AACA,QAAM,CAACmB,OAAD,EAAUC,UAAV,IAAwBpB,QAAQ,CAAC,EAAD,CAAtC;AACA,QAAM,CAACqB,iBAAD,EAAoBC,qBAApB,IAA6CtB,QAAQ,EAA3D;AACA,QAAM,CAACuB,KAAD,EAAQC,QAAR,IAAoBxB,QAAQ,EAAlC;;AAKA,QAAMyB,cAAc,GAAIC,KAAD,IAAW;AAChCR,IAAAA,WAAW,CAACQ,KAAK,CAACC,MAAN,CAAaC,KAAd,CAAX;AACAN,IAAAA,qBAAqB,CAACI,KAAK,CAACC,MAAN,CAAaC,KAAd,CAArB;AAED,GAJD;;AAMA,QAAMC,YAAY,GAAIH,KAAD,IAAW;AAE9BF,IAAAA,QAAQ,CAACE,KAAK,CAACC,MAAN,CAAaC,KAAd,CAAR;AAGD,GALD,CArBqB,CA8BrB;;;AAEA,QAAME,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAApB;AACA,QAAMC,WAAW,GAAGF,YAAY,CAACC,OAAb,CAAqB,OAArB,CAApB;AACA,QAAME,OAAO,GAAGH,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAhB;AACA,QAAMG,OAAO,GAAGJ,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAhB,CAnCqB,CAqCrB;;AAEA/B,EAAAA,SAAS,CAAC,MAAM;AACRmC,IAAAA,SAAS;AAEZ,GAHI,EAGF,EAHE,CAAT;;AAOE,QAAMA,SAAS,GAAG,YAAW;AACvB,UAAMC,QAAQ,GAAG,MAAMtC,KAAK,CAACuC,GAAN,CAAW,kBAAX,CAAvB;AACA,UAAMC,QAAQ,GAAG,MAAMF,QAAQ,CAACG,IAAT,CAAcC,IAArC;AACArB,IAAAA,UAAU,CAACmB,QAAD,CAAV;AAEL,GALD;;AAUI,MAAIG,QAAQ,GAAGvB,OAAO,CAACwB,MAAR,CAAe,UAAUF,IAAV,EAAe;AACzC,WAAOA,IAAI,CAACG,YAAL,KAAsBvB,iBAA7B;AACL,GAFgB,CAAf;AAIA,MAAIwB,YAAY,GAAG1B,OAAO,CAACwB,MAAR,CAAe,UAAUF,IAAV,EAAe;AAC7C,WAAOA,IAAI,CAACK,QAAL,KAAkBvB,KAAzB;AAEL,GAHoB,CAAnB,CA5De,CAiEvB;;AAEA,QAAMwB,MAAM,GAAGF,YAAY,CAACG,GAAb,CAAiBC,GAAG,IAAKA,GAAG,CAACC,EAA7B,CAAf;AAEA,QAAMC,cAAc,GAAGN,YAAY,CAACG,GAAb,CAAiBC,GAAG,IAAKA,GAAG,CAACG,gBAA7B,CAAvB;AAEA,QAAMC,YAAY,GAAGR,YAAY,CAACG,GAAb,CAAiBC,GAAG,IAAKA,GAAG,CAACK,cAA7B,CAArB;AAEA,MAAIC,WAAW,GAAG,EAAlB,CAzEuB,CA6EtB;;AAGC,QAAMC,SAAS,GAAG,MAAM;AAEpB,UAAMC,gBAAgB,GAAG/C,MAAM,CAACgD,SAAD,EAAY,aAAZ,CAA/B;AACA,UAAMC,cAAc,GAAGjD,MAAM,CAACkD,OAAD,EAAU,aAAV,CAA7B,CAHoB,CAKhB;AACA;;AAMM,QAAIC,MAAM,CAACC,IAAP,CAAYX,cAAZ,EAA4BY,MAA5B,KAAuC,CAAvC,IAA4CF,MAAM,CAACC,IAAP,CAAYT,YAAZ,EAA0BU,MAA1B,KAAqC,CAArF,EAAwF;AAGhF,YAAMC,kBAAkB,GAAGpD,gBAAgB,CAAC,IAAIqD,IAAJ,CAASR,gBAAT,CAAD,EAC7C;AAAES,QAAAA,KAAK,EAAE,IAAID,IAAJ,CAASd,cAAT,CAAT;AAAmCgB,QAAAA,GAAG,EAAE,IAAIF,IAAJ,CAASZ,YAAT;AAAxC,OAD6C,CAA3C;AAIF,YAAMe,gBAAgB,GAAGxD,gBAAgB,CAAC,IAAIqD,IAAJ,CAASN,cAAT,CAAD,EACzC;AAAEO,QAAAA,KAAK,EAAE,IAAID,IAAJ,CAASd,cAAT,CAAT;AAAmCgB,QAAAA,GAAG,EAAE,IAAIF,IAAJ,CAASZ,YAAT;AAAxC,OADyC,CAAzC;;AAQF,UAAGW,kBAAkB,IAAII,gBAAgB,KAAK,IAA9C,EAAoD;AAElDb,QAAAA,WAAW,gBAEL;AAAK,UAAA,SAAS,EAAC,cAAf;AAAA,iCACE;AAAA,oJACA;AAAA;AAAA;AAAA;AAAA,oBADA,eAEA;AAAA,yBAAKJ,cAAL,SAAwBE,YAAxB;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBAFN;AAciB,OAhBnB,MAgByB;AAGDE,QAAAA,WAAW,GAAG,EAAd;AACL;AAEZ,KArCX,MAqCiB;AAECA,MAAAA,WAAW,GAAG,EAAd;AAEP;AAIxB,GAzDD,CAhFqB,CA+IvB;;;AAGA,QAAM,CAACG,SAAD,EAAYW,YAAZ,IAA4BrE,QAAQ,CAAC,IAAD,CAA1C;AACA,QAAM,CAAC4D,OAAD,EAAUU,UAAV,IAAwBtE,QAAQ,CAAC,IAAD,CAAtC;AAGAM,EAAAA,cAAc,CAAC,IAAD,EAAOE,EAAP,CAAd;AACAD,EAAAA,gBAAgB,CAAC,IAAD,CAAhB,CAvJuB,CA4JvB;;AAEA,QAAMgE,KAAK,GAAG,GAAd;;AAGA,QAAMC,eAAe,GAAIC,CAAD,IAAO;AAEvB1E,IAAAA,KAAK,CAAC2E,QAAN,CAAeC,eAAf,GAAiC,IAAjC;AACA5E,IAAAA,KAAK,CAAC2E,QAAN,CAAeE,OAAf,CAAuBC,IAAvB,CAA4B,cAA5B,IAA8C,kBAA9C;AACA9E,IAAAA,KAAK,CAAC2E,QAAN,CAAeE,OAAf,CAAuBC,IAAvB,CAA4B,QAA5B,IAAwC,kBAAxC;AAII,UAAMrC,IAAI,GAAG;AAED+B,MAAAA,KAAK,EAAEA,KAFN;AAGDpC,MAAAA,OAAO,EAAEA;AAHR,KAAb;AAQEpC,IAAAA,KAAK,CAAC8E,IAAN,CAAW,sBAAX,EAAmCrC,IAAnC;AAKb,GArBD,CAjKuB,CA4LvB;;;AAEA,QAAMsC,QAAQ,GAAIC,IAAI,CAACC,GAAL,CAASpB,OAAO,GAAGF,SAAnB,CAAlB;AACA,QAAMuB,gBAAgB,GAAGF,IAAI,CAACG,IAAL,CAAUJ,QAAQ,IAAI,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAArB,CAAlB,CAAzB;AAEA,QAAMK,KAAK,GAAGtC,YAAY,CAACG,GAAb,CAAiBC,GAAG,IAAKA,GAAG,CAACmC,SAA7B,CAAd;AAEA,QAAMC,gBAAgB,GAAGF,KAAK,GAAGF,gBAAjC,CAnMuB,CAqMvB;;AAEA,QAAM,CAACK,SAAD,EAAYC,YAAZ,IAA4BvF,QAAQ,CAAC;AAEvCwF,IAAAA,KAAK,EAAE,EAFgC;AAGvCC,IAAAA,KAAK,EAAE,EAHgC;AAIvCC,IAAAA,KAAK,EAAE,EAJgC;AAKvCC,IAAAA,UAAU,EAAE,CAAC,EAAD;AAL2B,GAAD,CAA1C;;AASA,QAAMC,WAAW,GAAInB,CAAD,IAAO;AACzBA,IAAAA,CAAC,CAACoB,OAAF;AACAN,IAAAA,YAAY,CAAC,EAAC,GAAGD,SAAJ;AAAe,OAACb,CAAC,CAAC9C,MAAF,CAASmE,IAAV,GAAiBrB,CAAC,CAAC9C,MAAF,CAASC;AAAzC,KAAD,CAAZ;AAED,GAJD;;AAOA,QAAM,CAACmE,SAAD,EAAYC,YAAZ,IAA4BhG,QAAQ,CAAC,KAAD,CAA1C;;AAEA,QAAMiG,eAAe,GAAIxB,CAAD,IAAO;AAE/BuB,IAAAA,YAAY,CAACvB,CAAC,CAAC9C,MAAF,CAASuE,OAAV,CAAZ;AAGC,GALD,CAzNuB,CAmOvB;;;AAGQ,QAAMC,UAAU,GAAI1B,CAAD,IAAO;AAKxB1E,IAAAA,KAAK,CAAC2E,QAAN,CAAeC,eAAf,GAAiC,IAAjC;AACA5E,IAAAA,KAAK,CAAC2E,QAAN,CAAeE,OAAf,CAAuBC,IAAvB,CAA4B,cAA5B,IAA8C,kBAA9C;AACA9E,IAAAA,KAAK,CAAC2E,QAAN,CAAeE,OAAf,CAAuBC,IAAvB,CAA4B,QAA5B,IAAwC,kBAAxC;AAEAJ,IAAAA,CAAC,CAAC2B,cAAF;AAQA,UAAM5D,IAAI,GAAG;AAEXgD,MAAAA,KAAK,EAAEF,SAAS,CAACE,KAFN;AAGXC,MAAAA,KAAK,EAAEH,SAAS,CAACG,KAHN;AAIXC,MAAAA,KAAK,EAAEJ,SAAS,CAACI,KAJN;AAKXW,MAAAA,aAAa,EAAEN,SALJ;AAMXO,MAAAA,SAAS,EAAEvD,MANA;AAOXwD,MAAAA,kBAAkB,EAAE7C,SAPT;AAQX8C,MAAAA,eAAe,EAAE5C,OARN;AASXzB,MAAAA,OAAO,EAAEA,OATE;AAUXwD,MAAAA,UAAU,EAAE;AAVD,KAAb;AAcI5F,IAAAA,KAAK,CAACuC,GAAN,CAAU,sBAAV,EAAkCmE,IAAlC,CAAuCC,QAAQ,IAAI;AAGnD3G,MAAAA,KAAK,CAAC8E,IAAN,CAAY,iBAAZ,EAA8BrC,IAA9B,EAAoCiE,IAApC,CAAyCE,GAAG,IAAI;AAE5C,YAAGA,GAAG,CAACnE,IAAJ,CAASoE,MAAT,KAAoB,GAAvB,EACA;AAEMnG,UAAAA,IAAI,CAACoG,IAAL,CAAU;AACRC,YAAAA,KAAK,EAAEH,GAAG,CAACnE,IAAJ,CAASuE,OADR;AAERC,YAAAA,iBAAiB,EAAE,IAFX;AAGRC,YAAAA,IAAI,EAAE;AAHE,WAAV,EAIGR,IAJH,CAISS,MAAD,IAAY;AAElB,gBAAIA,MAAM,CAACC,WAAX,EAAwB;AAExB3C,cAAAA,eAAe;AAEfxD,cAAAA,OAAO,CAACoG,IAAR,CAAa,aAAb;AAGC;AAEF,WAfD;AAiBL,SApBD,MAwBA;AAEC7B,UAAAA,YAAY,CAAC,EAAC,GAAGD,SAAJ;AAAeK,YAAAA,UAAU,EAAEgB,GAAG,CAACnE,IAAJ,CAAS6E;AAApC,WAAD,CAAZ;AAEA;AAEJ,OAhCD;AAiCH,KApCG;AAsCb,GArEO;;AAyEJ,MAAIzD,OAAO,KAAK,IAAhB,EAAsB;AAEf0D,IAAAA,OAAO,CAACC,GAAR,CAAYpE,cAAZ,EAFe,CAGpB;AAEA;AASA;AACA;AACA;AACA;AACA;AAGA;AAKA;AAEA;AACA;AACA;AAGA;AAMD,GAtVkB,CA6VrB;;;AAEA,MAAIqE,cAAc,GAAG,EAArB;;AAGA,MAAI9D,SAAS,KAAK,IAAlB,EAAwB;AAEtB8D,IAAAA,cAAc,gBACF,QAAC,UAAD;AACJ,MAAA,QAAQ,EAAE5D,OADN;AAEJ,MAAA,QAAQ,EAAG6D,IAAD,IAAUnD,UAAU,CAACmD,IAAD,CAF1B;AAGJ,MAAA,OAAO,EAAE9G,OAAO,CAAC+C,SAAD,EAAY,CAAZ,CAHZ;AAIJ,MAAA,eAAe,EAAC,8BAJZ;AAKJ,MAAA,UAAU,EAAC,aALP;AAMJ,MAAA,2BAA2B;AANvB;AAAA;AAAA;AAAA;AAAA,YADZ;AAaD,GAfD,MAeO;AAEE8D,IAAAA,cAAc,GAAG,EAAjB;AACR;;AAKC,sBAEA;AAAK,IAAA,SAAS,EAAC,qBAAf;AAAA,2BACE;AAAM,MAAA,QAAQ,EAAErB,UAAhB;AAA4B,MAAA,SAAS,EAAC,WAAtC;AAAA,8BAEE;AAAA;AAAA;AAAA;AAAA,cAFF,eAGE;AAAO,QAAA,OAAO,EAAC,EAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAHF,eAIE;AAAO,QAAA,IAAI,EAAC,OAAZ;AAAoB,QAAA,QAAQ,EAAEP,WAA9B;AAA2C,QAAA,IAAI,EAAC,MAAhD;AAAuD,QAAA,WAAW,EAAE9D,WAApE;AAAiF,QAAA,KAAK,EAAEwD,SAAS,CAACE;AAAlG;AAAA;AAAA;AAAA;AAAA,cAJF,eAKE;AAAA;AAAA;AAAA;AAAA,cALF,eAME;AAAM,QAAA,SAAS,EAAC,eAAhB;AAAA,kBAAiCF,SAAS,CAACK,UAAV,CAAqBH;AAAtD;AAAA;AAAA;AAAA;AAAA,cANF,eAOE;AAAA;AAAA;AAAA;AAAA,cAPF,eAQE;AAAO,QAAA,OAAO,EAAC,EAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cARF,eAaE;AAAO,QAAA,IAAI,EAAC,OAAZ;AAAoB,QAAA,QAAQ,EAAEI,WAA9B;AAA2C,QAAA,IAAI,EAAC,MAAhD;AAAuD,QAAA,WAAW,EAAE3D,WAApE;AAAiF,QAAA,KAAK,EAAEqD,SAAS,CAACG;AAAlG;AAAA;AAAA;AAAA;AAAA,cAbF,eAcE;AAAA;AAAA;AAAA;AAAA,cAdF,eAeE;AAAM,QAAA,SAAS,EAAC,eAAhB;AAAA,kBAAiCH,SAAS,CAACK,UAAV,CAAqBF;AAAtD;AAAA;AAAA;AAAA;AAAA,cAfF,eAgBE;AAAA;AAAA;AAAA;AAAA,cAhBF,eAiBE;AAAO,QAAA,OAAO,EAAC,EAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAjBF,eAkBE;AAAO,QAAA,IAAI,EAAC,OAAZ;AAAoB,QAAA,QAAQ,EAAEG,WAA9B;AAA2C,QAAA,IAAI,EAAC,MAAhD;AAAuD,QAAA,WAAW,EAAE1D,OAApE;AAA6E,QAAA,KAAK,EAAEoD,SAAS,CAACI;AAA9F;AAAA;AAAA;AAAA;AAAA,cAlBF,eAmBE;AAAA;AAAA;AAAA;AAAA,cAnBF,eAoBE;AAAM,QAAA,SAAS,EAAC,eAAhB;AAAA,kBAAiCJ,SAAS,CAACK,UAAV,CAAqBD;AAAtD;AAAA;AAAA;AAAA;AAAA,cApBF,eAqBE;AAAA;AAAA;AAAA;AAAA,cArBF,eAuBC,QAAC,WAAD;AAAa,QAAA,EAAE,EAAE;AAAEgC,UAAAA,CAAC,EAAE,CAAL;AAAQC,UAAAA,QAAQ,EAAE;AAAlB,SAAjB;AAAA,gCAEC,QAAC,MAAD;AACE,UAAA,KAAK,EAAE1G,QADT;AAEE,UAAA,QAAQ,EAAEQ,cAFZ;AAGE,UAAA,SAAS,MAHX;AAIE,UAAA,YAAY,MAJd;AAAA,kCAME,QAAC,QAAD;AAAU,YAAA,IAAI,EAAC,cAAf;AAA8B,YAAA,KAAK,EAAE,EAArC;AAAyC,YAAA,QAAQ,MAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBANF,eAOE,QAAC,QAAD;AAAU,YAAA,IAAI,EAAC,cAAf;AAA8B,YAAA,KAAK,EAAE,OAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAPF,eAQE,QAAC,QAAD;AAAU,YAAA,IAAI,EAAC,cAAf;AAA8B,YAAA,KAAK,EAAE,OAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBARF,eASE,QAAC,QAAD;AAAU,YAAA,IAAI,EAAC,cAAf;AAA8B,YAAA,KAAK,EAAE,QAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBATF,eAUE,QAAC,QAAD;AAAU,YAAA,IAAI,EAAC,cAAf;AAA8B,YAAA,KAAK,EAAE,QAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAVF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFD,eAcC;AAAA;AAAA;AAAA;AAAA,gBAdD,eAeC,QAAC,MAAD;AACE,UAAA,KAAK,EAAEF,KADT;AAEE,UAAA,QAAQ,EAAEM,YAFZ;AAGE,UAAA,SAAS,MAHX;AAIE,UAAA,YAAY,MAJd;AAAA,kCAME,QAAC,QAAD;AAAU,YAAA,KAAK,EAAE,EAAjB;AAAqB,YAAA,QAAQ,MAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBANF,EAOGa,QAAQ,CAACM,GAAT,CAAaC,GAAG,iBACf,QAAC,QAAD;AAAuB,YAAA,KAAK,EAAEA,GAAG,CAACH,QAAlC;AAAA,sBAA6CG,GAAG,CAACH;AAAjD,aAAeG,GAAG,CAACC,EAAnB;AAAA;AAAA;AAAA;AAAA,kBADD,CAPH;AAAA;AAAA;AAAA;AAAA;AAAA,gBAfD;AAAA;AAAA;AAAA;AAAA;AAAA,cAvBD,eAsDE;AAAA;AAAA;AAAA;AAAA,cAtDF,eAwDG,QAAC,UAAD;AACG,QAAA,QAAQ,EAAEQ,SADb;AAEG,QAAA,QAAQ,EAAG+D,IAAD,IAAUpD,YAAY,CAACoD,IAAD,CAFnC;AAGG,QAAA,OAAO,EAAE9G,OAAO,CAAC,IAAIsD,IAAJ,EAAD,EAAa,CAAb,CAHnB;AAIG,QAAA,eAAe,EAAC,8BAJnB;AAKG,QAAA,UAAU,EAAC,aALd;AAMG,QAAA,2BAA2B;AAN9B;AAAA;AAAA;AAAA;AAAA,cAxDH,eAkEE;AAAA;AAAA;AAAA;AAAA,cAlEF,EAqEOuD,cArEP,eAuEI;AAAA;AAAA;AAAA;AAAA,cAvEJ,eAyEI;AAAM,QAAA,SAAS,EAAC,eAAhB;AAAA,kBAAiClC,SAAS,CAACK,UAAV,CAAqBY;AAAtD;AAAA;AAAA;AAAA;AAAA,cAzEJ,eA2EK;AAAM,QAAA,SAAS,EAAC,eAAhB;AAAA,kBAAiCjB,SAAS,CAACK,UAAV,CAAqBa;AAAtD;AAAA;AAAA;AAAA;AAAA,cA3EL,EA6EOjD,WA7EP,eA+EI;AAAA;AAAA;AAAA;AAAA,cA/EJ,eAgFG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAhFH,eAmFE;AAAA;AAAA;AAAA;AAAA,cAnFF,eAoFE;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA,+BACA;AAAG,UAAA,SAAS,EAAC,WAAb;AAAA,6CAAwC8B,gBAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA,cApFF,eAuFE;AAAA;AAAA;AAAA;AAAA,cAvFF,eAwFE;AAAO,QAAA,IAAI,EAAC,eAAZ;AAA4B,QAAA,QAAQ,EAAEY,eAAtC;AAAuD,QAAA,SAAS,EAAC,UAAjE;AAA4E,QAAA,IAAI,EAAC,UAAjF;AAA4F,QAAA,KAAK,EAAEF;AAAnG;AAAA;AAAA;AAAA;AAAA,cAxFF,kCAwFiI;AAAG,QAAA,IAAI,EAAEjG,YAAT;AAAwB,QAAA,GAAG,EAAC,qBAA5B;AAAkD,QAAA,MAAM,EAAC,QAAzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAxFjI,eAyFE;AAAA;AAAA;AAAA;AAAA,cAzFF,eA0FE;AAAM,QAAA,SAAS,EAAC,eAAhB;AAAA,kBAAiCwF,SAAS,CAACK,UAAV,CAAqBU;AAAtD;AAAA;AAAA;AAAA;AAAA,cA1FF,eA2FE;AAAA;AAAA;AAAA;AAAA,cA3FF,eA4FE;AAAQ,QAAA,IAAI,EAAC,QAAb;AAAsB,QAAA,SAAS,EAAC,gBAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cA5FF,eA6FE;AAAA;AAAA;AAAA;AAAA,cA7FF,eA8FE;AAAA;AAAA;AAAA;AAAA,cA9FF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,UAFA;AAqGH,CA9dD;;GAAMtF,Q;UAGUzB,U;;;KAHVyB,Q;AAgeN,eAAeA,QAAf","sourcesContent":["import React from 'react'\r\nimport { Link, useHistory } from 'react-router-dom'\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Select from '@material-ui/core/Select';\r\nimport createTheme from '@material-ui/core/styles';\r\nimport adatkezelesi from '../adatkezelesi.pdf';\r\nimport axios from 'axios'\r\nimport {useState, useEffect} from 'react'\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport {createMuiTheme, ThemeProvider} from '@material-ui/core';\r\nimport DatePicker from \"react-datepicker\";\r\nimport { registerLocale, setDefaultLocale } from  \"react-datepicker\";\r\nimport hu from 'date-fns/locale/hu';\r\nimport Swal from 'sweetalert2'\r\nimport { format, addDays, isWithinInterval } from 'date-fns';\r\nvar _ = require('lodash');\r\n\r\n\r\n\r\nconst RentForm = () => {\r\n\r\n\r\nconst history = useHistory();\r\n\r\n//   MUI Selects Setup\r\n\r\n  const [category, setCategory] = React.useState('');\r\n  const [carInfo, setCarInfo] = useState([]);\r\n  const [selected_category, Set_selected_category] = useState();\r\n  const [model, setModel] = useState();\r\n\r\n\r\n  \r\n\r\n  const handleCategory = (event) => {\r\n    setCategory(event.target.value);\r\n    Set_selected_category(event.target.value);\r\n\r\n  };\r\n\r\n  const handleModels = (event) => {\r\n    \r\n    setModel(event.target.value);\r\n   \r\n\r\n  };\r\n\r\n\r\n\r\n  // Auto fills the form with user's details + user id: \r\n\r\n  const vezetek_nev = localStorage.getItem('v_nev');\r\n  const kereszt_nev = localStorage.getItem('k_nev');\r\n  const telefon = localStorage.getItem('phone');\r\n  const user_id = localStorage.getItem('user_id');\r\n\r\n  //  Gets the car details... \r\n\r\n  useEffect(() => {\r\n          fetchData();\r\n          \r\n      }, []);\r\n\r\n\r\n\r\n    const fetchData = async() => {\r\n          const car_data = await axios.get(`/api/modelljeink`);\r\n          const car_info = await car_data.data.cars;\r\n          setCarInfo(car_info);\r\n\r\n    };\r\n\r\n\r\n\r\n\r\n        let car_list = carInfo.filter(function (cars){\r\n            return cars.car_category === selected_category;\r\n      })\r\n\r\n        let selected_car = carInfo.filter(function (cars){\r\n            return cars.car_name === model;\r\n            \r\n      })\r\n\r\n///  Car's ID\r\n\r\nconst car_id = selected_car.map(car => (car.id));\r\n\r\nconst car_rent_start = selected_car.map(car => (car.car_rental_begin));\r\n\r\nconst car_rent_end = selected_car.map(car => (car.car_rental_end));\r\n\r\nvar DateWarning = \"\";\r\n\r\n\r\n\r\n ///  Check if dates are vaild\r\n\r\n\r\n  const DateCheck = () => {\r\n\r\n      const formatedStartDay = format(startDate, \"yyyy-MM-dd.\");\r\n      const formatedEndDay = format(endDate, \"yyyy-MM-dd.\");\r\n    \r\n          // console.log(car_rent_start);\r\n          // console.log(car_rent_end);\r\n\r\n   \r\n\r\n\r\n\r\n                if( Object.keys(car_rent_start).length !== 0 && Object.keys(car_rent_end).length !== 0 ){\r\n\r\n\r\n                        const checkStartInterval = isWithinInterval(new Date(formatedStartDay),\r\n                      { start: new Date(car_rent_start), end: new Date(car_rent_end) }\r\n                      );\r\n\r\n                      const checkEndInterval = isWithinInterval(new Date(formatedEndDay),\r\n                      { start: new Date(car_rent_start), end: new Date(car_rent_end) }\r\n                      );\r\n\r\n\r\n\r\n\r\n\r\n                    if(checkStartInterval || checkEndInterval === true) {\r\n\r\n                      DateWarning = (\r\n                        \r\n                            <div className=\"date_warning\">\r\n                              <p>Az Ön által válaszott modell az alábbi idő intervallumban kölcsönzés alatt áll:\r\n                              <br />\r\n                              <h1>{car_rent_start} - {car_rent_end} </h1>\r\n                  \r\n                              Kérjük válasszon másik modellt, vagy kölcsönzési időpontot!\r\n                              </p>\r\n                            </div>\r\n                      \r\n                      );\r\n\r\n\r\n                                      } else {\r\n\r\n\r\n                                            DateWarning = \"\";\r\n                                      }\r\n\r\n                          } else {\r\n\r\n                                  DateWarning = \"\";\r\n\r\n                          }\r\n\r\n             \r\n\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n////  Datepicker setup\r\n\r\n\r\nconst [startDate, setStartDate] = useState(null)\r\nconst [endDate, setendDate] = useState(null)\r\n\r\n\r\nregisterLocale('hu', hu)\r\nsetDefaultLocale('hu');\r\n\r\n\r\n\r\n\r\n/// Send Notification \r\n\r\nconst alert = 200;\r\n\r\n\r\nconst sendNotifcation = (e) => {\r\n\r\n        axios.defaults.withCredentials = true;\r\n        axios.defaults.headers.post['Content-Type'] = 'application/json';\r\n        axios.defaults.headers.post['Accept'] = 'application/json'; \r\n\r\n      \r\n\r\n            const data = {\r\n\r\n                        alert: alert,\r\n                        user_id: user_id,\r\n\r\n                      }\r\n\r\n\r\n              axios.post('/api/kolcsonzes/push', data);\r\n             \r\n  \r\n\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n//  Caluclated Price\r\n\r\nconst duration =  Math.abs(endDate - startDate);\r\nconst duration_in_days = Math.ceil(duration / (1000 * 60 * 60 * 24)); \r\n\r\nconst price = selected_car.map(car => (car.car_price));\r\n\r\nconst calculated_price = price * duration_in_days;\r\n\r\n///  Handle form input \r\n\r\nconst [formInput, setformInput] = useState({\r\n\r\n    v_nev: '',\r\n    k_nev: '',\r\n    phone: '',\r\n    error_list: [''],\r\n    \r\n});\r\n\r\nconst handleInput = (e) => {\r\n  e.persist();\r\n  setformInput({...formInput, [e.target.name]: e.target.value});\r\n\r\n}\r\n\r\n\r\nconst [ischecked, setischecked] = useState(false);\r\n\r\nconst handleIsChecked = (e) => {\r\n\r\nsetischecked(e.target.checked);\r\n\r\n\r\n}\r\n\r\n\r\n\r\n\r\n//  Rent form submit\r\n\r\n\r\n        const rentSubmit = (e) => {\r\n\r\n            \r\n          \r\n\r\n          axios.defaults.withCredentials = true;\r\n          axios.defaults.headers.post['Content-Type'] = 'application/json';\r\n          axios.defaults.headers.post['Accept'] = 'application/json'; \r\n\r\n          e.preventDefault();\r\n\r\n\r\n\r\n\r\n          \r\n\r\n         \r\n          const data = {\r\n\r\n            v_nev: formInput.v_nev,\r\n            k_nev: formInput.k_nev,\r\n            phone: formInput.phone,\r\n            adat_checkbox: ischecked,\r\n            modell_id: car_id,\r\n            kolcsonzes_kezdete: startDate,\r\n            kolcsonzes_vege: endDate,\r\n            user_id: user_id,\r\n            error_list: [],\r\n\r\n          }\r\n\r\n              axios.get('/sanctum/csrf-cookie').then(response => {\r\n\r\n\r\n              axios.post(`/api/kolcsonzes`, data).then(res => {\r\n\r\n                  if(res.data.status === 200)\r\n                  {\r\n\r\n                        Swal.fire({\r\n                          title: res.data.message,\r\n                          confirmButtonText: 'Ok',\r\n                          icon: 'success'\r\n                        }).then((result) => {\r\n                        \r\n                          if (result.isConfirmed) {\r\n\r\n                          sendNotifcation();\r\n\r\n                          history.push('/kolcsonzes');\r\n                         \r\n\r\n                          }\r\n\r\n                        })\r\n\r\n                  } \r\n                  \r\n                  else \r\n                  \r\n                  {\r\n\r\n                   setformInput({...formInput, error_list: res.data.validation_errors});\r\n\r\n                  }\r\n\r\n              });\r\n          });\r\n\r\n};\r\n\r\n\r\n\r\n    if (endDate !== null) {\r\n      \r\n           console.log(car_rent_start);\r\n      // Calls the checkdate function here\r\n\r\n      // if(car_rent_start.valueOf() === null) {\r\n\r\n     \r\n\r\n\r\n\r\n\r\n\r\n\r\n      //     console.log(\"nigger\");\r\n      //     console.log(car_rent_start);\r\n      //     console.log(car_rent_end);\r\n      //     console.log(typeof(car_rent_start));\r\n      //     console.log(typeof(car_rent_end));\r\n         \r\n\r\n      //     DateWarning = \"\";\r\n          \r\n\r\n        \r\n\r\n      // }  else {\r\n\r\n      //     console.log(\"nem nigger\");\r\n      //      console.log(car_rent_start.valueOf());\r\n      //     DateCheck();\r\n         \r\n            \r\n      //       }\r\n\r\n\r\n      \r\n     \r\n\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n  ////  If no starting date has been selected:\r\n\r\n  var kolcsonzesVege = '';\r\n\r\n\r\n  if (startDate !== null) {\r\n\r\n    kolcsonzesVege = (\r\n                <DatePicker\r\n            selected={endDate}\r\n            onChange={(date) => setendDate(date)}\r\n            minDate={addDays(startDate, 1)}\r\n            placeholderText=\"Kölcsönzés vége:\"\r\n            dateFormat=\"yyyy-MM-dd.\"\r\n            showDisabledMonthNavigation\r\n          />\r\n\r\n    );\r\n\r\n\r\n  } else {\r\n\r\n           kolcsonzesVege = '';\r\n  }\r\n\r\n\r\n\r\n\r\n    return (\r\n\r\n    <div className=\"rent_form_container\">\r\n      <form onSubmit={rentSubmit} className=\"rent_form\">\r\n      \r\n        <br />\r\n        <label htmlFor=\"\">Vezetéknév:</label>\r\n        <input name=\"v_nev\" onChange={handleInput} type=\"text\" Placeholder={vezetek_nev} value={formInput.v_nev} />\r\n        <br />\r\n        <span className=\"error_message\">{formInput.error_list.v_nev}</span>\r\n        <br />\r\n        <label htmlFor=\"\">Keresztnév:</label>  \r\n\r\n        \r\n\r\n\r\n        <input name=\"k_nev\" onChange={handleInput} type=\"text\" Placeholder={kereszt_nev} value={formInput.k_nev} />\r\n        <br />\r\n        <span className=\"error_message\">{formInput.error_list.k_nev}</span>\r\n        <br />\r\n        <label htmlFor=\"\">Telefonszám: (Helyes formátum: 201231234 legfeljebb 9 karakter)</label>\r\n        <input name=\"phone\" onChange={handleInput} type=\"text\" Placeholder={telefon} value={formInput.phone} />\r\n        <br />\r\n        <span className=\"error_message\">{formInput.error_list.phone}</span>\r\n        <br />\r\n\r\n       <FormControl sx={{ m: 1, minWidth: 800 }}>\r\n       \r\n        <Select\r\n          value={category}\r\n          onChange={handleCategory}\r\n          autoWidth\r\n          displayEmpty>\r\n\r\n          <MenuItem name='car_category' value={''} disabled >Kategória</MenuItem>\r\n          <MenuItem name='car_category' value={'sedan'}>Sedan</MenuItem>\r\n          <MenuItem name='car_category' value={'kombi'}>Kombi</MenuItem>\r\n          <MenuItem name='car_category' value={'hibrid'}>Hibrid</MenuItem>\r\n          <MenuItem name='car_category' value={'furgon'}>Furgon</MenuItem>\r\n        </Select>\r\n        <br />\r\n        <Select\r\n          value={model}\r\n          onChange={handleModels}\r\n          autoWidth\r\n          displayEmpty>\r\n\r\n          <MenuItem value={''} disabled >Modell</MenuItem>\r\n          {car_list.map(car => (\r\n            <MenuItem key={car.id} value={car.car_name}>{car.car_name}</MenuItem> ))}\r\n        </Select>\r\n\r\n\r\n      </FormControl>\r\n       \r\n\r\n       \r\n        <br />\r\n        \r\n         <DatePicker\r\n            selected={startDate}\r\n            onChange={(date) => setStartDate(date)}\r\n            minDate={addDays(new Date(), 1)}\r\n            placeholderText=\"Kölcsönzés kezdete:\"\r\n            dateFormat=\"yyyy-MM-dd.\"\r\n            showDisabledMonthNavigation\r\n        />\r\n\r\n\r\n        <br />\r\n\r\n\r\n            {kolcsonzesVege}\r\n\r\n          <br />\r\n          \r\n          <span className=\"error_message\">{formInput.error_list.kolcsonzes_kezdete}</span>\r\n\r\n           <span className=\"error_message\">{formInput.error_list.kolcsonzes_vege}</span>\r\n\r\n            {DateWarning}\r\n\r\n          <br />\r\n         <p>( A minimum kölcsönzési idő 1 nap! )</p>\r\n\r\n      \r\n        <br />\r\n        <div className=\"price_box\">\r\n        <p className=\"price_tag\">Ár:  Kaució + {calculated_price} Ft </p>\r\n        </div>\r\n        <br />\r\n        <input name=\"adat_checkbox\" onChange={handleIsChecked} className=\"checkbox\" type=\"checkbox\" value={ischecked} />* Elfogadom az <a href={adatkezelesi}  rel=\"noopener noreferrer\" target=\"_blank\">adatkezelési nyilatkozatot.</a> \r\n        <br />\r\n        <span className=\"error_message\">{formInput.error_list.adat_checkbox}</span>\r\n        <br />\r\n        <button type=\"submit\" className=\"primary_button\">Kölcsönzés ⯈</button>\r\n        <br />\r\n        <br />\r\n      </form>\r\n    </div>\r\n    )\r\n}\r\n\r\nexport default RentForm\r\n"]},"metadata":{},"sourceType":"module"}